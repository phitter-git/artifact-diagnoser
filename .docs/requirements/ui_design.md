# UI設計方針

このドキュメントでは、聖遺物診断器のUI/UX設計方針とコンポーネント構成を定義します。

---

## 📖 目次

1. [デザイン原則](#デザイン原則)
2. [カラースキーム](#カラースキーム)
3. [レイアウト構成](#レイアウト構成)
4. [画面別UI設計](#画面別ui設計)
5. [コンポーネント一覧](#コンポーネント一覧)
6. [レスポンシブ対応](#レスポンシブ対応)
7. [アクセシビリティ](#アクセシビリティ)

---

## 1. デザイン原則

### 基本方針

#### 1.1 Genshin Impactの世界観を踏襲
- ゲーム内UIのカラーパレットを参考
- アイコンや装飾はGenshin風に統一
- フォントは読みやすさ優先（ゲーム内フォント使用は権利上注意）

#### 1.2 データの視覚化を重視
- 複雑な数値も直感的に理解できるよう視覚化
- グラフ、プログレスバー、色分けを活用
- 重要な情報は目立つように配置

#### 1.3 操作のシンプルさ
- 1画面につき1つの主要アクション
- タップ/クリックでの直感的な操作
- 迷わないナビゲーション

#### 1.4 大きく見やすいUI
- フォントサイズは18-20pxを基本に
- アイコンは80x80px以上
- マーカーやバッジも視認性を優先
- 余白を十分に確保（スペーシング: 8-16px）

---

## 2. カラースキーム

### プライマリカラー

Genshin Impactのレアリティカラーを基本とします。

| 用途 | 色 | HEX | 使用場面 |
|------|-----|-----|---------|
| **Sランク** | � ダークオレンジ | `#FF8C00` | S評価（最高Tier 4） |
| **Aランク** | 🟪 パープル | `#A256E1` | A評価（Tier 3） |
| **Bランク** | 🟦 ブルー | `#4A90E2` | B評価（Tier 2） |
| **Cランク** | 🟩 グリーン | `#73C990` | C評価（Tier 1） |
| **SS** | 🟨 ゴールド | `#FFD700` | スコアベースの最高ランク |

### セカンダリカラー

| 用途 | 色 | HEX |
|------|-----|-----|
| 背景 | ダークブルー | `#1A2332` |
| カード背景 | ダークグレー | `#2C3E50` |
| テキスト | ホワイト | `#FFFFFF` |
| サブテキスト | ライトグレー | `#B0B0B0` |
| アクセント | オレンジ | `#FF9800` |

---

## 3. レイアウト構成

### 基本レイアウト

```
┌─────────────────────────────────────┐
│  Header (ナビゲーション)              │
├─────────────────────────────────────┤
│                                     │
│                                     │
│  Main Content                       │
│  (画面ごとに異なる)                  │
│                                     │
│                                     │
├─────────────────────────────────────┤
│  Footer (オプション)                 │
└─────────────────────────────────────┘
```

### グリッドシステム
- **デスクトップ**: 12カラムグリッド
- **タブレット**: 8カラムグリッド
- **モバイル**: 4カラムグリッド

### スペーシング
- **Extra Small (XS)**: 4px
- **Small (S)**: 8px
- **Medium (M)**: 16px
- **Large (L)**: 24px
- **Extra Large (XL)**: 32px

---

## 4. 画面別UI設計

### 4.1 ホーム画面（UID入力）

```
┌─────────────────────────────────────┐
│  ╔═══════════════════════════════╗  │
│  ║   聖遺物診断器                 ║  │
│  ║   Artifact Diagnoser          ║  │
│  ╚═══════════════════════════════╝  │
├─────────────────────────────────────┤
│                                     │
│  UIDを入力してください               │
│  ┌─────────────────┐               │
│  │  123456789      │  [読み込み]   │
│  └─────────────────┘               │
│                                     │
│  💡 UIDはゲーム内で確認できます       │
│                                     │
│  ─────────────────────              │
│                                     │
│  📚 前回のデータ                     │
│  ┌─────────────────────────────┐   │
│  │  UID: 123456789              │   │
│  │  最終更新: 2025-10-12 14:30  │   │
│  │  [このデータを読み込む]        │   │
│  └─────────────────────────────┘   │
└─────────────────────────────────────┘
```

### 4.2 聖遺物一覧画面

```
┌─────────────────────────────────────┐
│  ← 戻る  │  聖遺物一覧  │  設定 ⚙    │
├─────────────────────────────────────┤
│  スコア計算対象を選択:               │
│  ☑会心率 ☑会心ダメージ ☐攻撃力%    │
│  ☐防御力% ☐HP% ☐元素熟知 ☐元チャ   │
├─────────────────────────────────────┤
│  ┌─────────────┐ ┌─────────────┐  │
│  │ 🌸          │ │ 🪶          │  │
│  │             │ │             │  │
│  │ 花          │ │ 羽          │  │
│  │ HP 4780     │ │ 攻撃力 311  │  │
│  │             │ │             │  │
│  │ ○ 会心率 3.9%│ │ ● 会心率 7.8%│  │
│  │ ○ 会心ダメ7.8%│ │ ○ 会心ダメ20.2%│  │
│  │ ○ 攻撃力%9.9%│ │ ○ 防御力%6.5%│  │
│  │ ○ 防御力%6.5%│ │ ○ 元素熟知 21 │  │
│  │             │ │             │  │
│  │ ──────────  │ │ ──────────  │  │
│  │ スコア: 45.7│ │ スコア: 38.2│  │
│  │        [S]  │ │        [A]  │  │
│  └─────────────┘ └─────────────┘  │
└─────────────────────────────────────┘
```

**実装済みの機能:**
- カードサイズ: 340×360px（1.5倍拡大）
- フォントサイズ: 18px（通常体、太字なし）
- マーカー: ●（選択）/○（非選択）、サイズ20px
- ランク表示: 半透明ウォーターマーク（opacity 0.15、縁取り付き）
- スコア表示: カード下部、選択中のステータスのみ計算
- 部位別基準: 花羽（基本）、砂/杯（-5.0）、冠（-10.0）

### 4.3 聖遺物詳細画面

```
┌─────────────────────────────────────┐
│  ← 一覧へ  │  聖遺物詳細             │
├─────────────────────────────────────┤
│  ┌─────────────────────────────┐   │
│  │  🌸              花          │   │
│  │  (80x80)        HP 4780     │   │
│  └─────────────────────────────┘   │
│                                     │
│  強化レベル                          │
│  [+0] [+4] [+8] [+12] [+16] [+20]   │
│                                     │
│  サブステータス                       │
│  ┌─────────────────────────────┐   │
│  │ ○ 会心率    3.9%  +3.5% [S] │   │
│  │ ○ 会心ダメージ 7.8%  +7.8% [S] │   │
│  │ ○ 攻撃力%   9.9%            │   │
│  │ ○ 防御力%   6.5%            │   │
│  └─────────────────────────────┘   │
└─────────────────────────────────────┘
```

**実装済みの機能:**
- ヘッダー: アイコン（80×80px）+ 部位名+メインステータス
- 強化レベルタブ: +0〜+20の切り替え
- サブステータス表示:
  - マーカー: ○（サイズ20px）
  - フォント: 18px、通常体
  - 現在値: %付き、小数点1桁
  - 増加値: +X.X%、Tier別色分け背景
  - ランクバッジ: S/A/B/C、色付き
  - 右側余白: 95px固定（レイアウトの揃え）

### 4.4 スコアリング設定画面

```
┌─────────────────────────────────────┐
│  ← 戻る  │  スコア設定               │
├─────────────────────────────────────┤
│  評価するステータスを選択             │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ ☑ 会心率                     │   │
│  │ ☑ 会心ダメージ               │   │
│  │ ☑ 攻撃力%                    │   │
│  │ ☐ 防御力%                    │   │
│  │ ☐ HP%                        │   │
│  │ ☐ 元素熟知                   │   │
│  │ ☐ 元素チャージ効率           │   │
│  └─────────────────────────────┘   │
│                                     │
│  プリセット                          │
│  ┌─────┐ ┌─────┐ ┌─────┐        │
│  │会心  │ │攻撃  │ │元素  │        │
│  │特化  │ │特化  │ │反応  │        │
│  └─────┘ └─────┘ └─────┘        │
│                                     │
│  [設定を保存]                        │
└─────────────────────────────────────┘
```

---

## 5. コンポーネント一覧

### 5.1 表示系コンポーネント

#### ReliquaryCardView（聖遺物カード）
```dart
class ReliquaryCardView extends StatelessWidget {
  final ReliquarySummary summary;
  final bool showInitialValues;
  final Map<String, bool> selectedStats; // スコア計算対象
  final VoidCallback? onTap;
  
  // 聖遺物の概要を表示するカード
  // サイズ: 340×360px（固定）
  // - アイコン（80×80px）
  // - 部位名（灰色、titleMedium）
  // - メインステータス（黒字、18px）
  // - サブステータス一覧（マーカー+ラベル+値）
  //   - 選択中: ●（塗りつぶし）
  //   - 非選択: ○（白抜き）
  // - スコア表示（下部、Divider区切り）
  // - ランクバッジ（半透明ウォーターマーク、縁取り付き）
  //   - 部位別基準で自動判定
  //   - 花羽: 基本基準
  //   - 砂/杯: -5.0寛容
  //   - 冠: -10.0寛容
}
```

#### ReliquarySummaryView（聖遺物詳細）
```dart
class ReliquarySummaryView extends StatefulWidget {
  final ReliquarySummary summary;
  final StatAppendResolver statAppendResolver;
  
  // 聖遺物の詳細情報を表示
  // - ヘッダー（一覧と同じレイアウト）
  //   - アイコン（80×80px）+ 部位名+メインステータス
  // - 強化レベルタブ（+0〜+20）
  // - サブステータス詳細（SubstatDetailView）
}
```

#### SubstatDetailView（サブステータス詳細）
```dart
class SubstatDetailView extends StatelessWidget {
  final SubstatSummary substat;
  final int currentLevel;
  final bool isInitial;
  final StatAppendResolver statAppendResolver;
  
  // サブステータスの詳細表示
  // - マーカー（○、20px）
  // - ラベル（18px、normal）
  // - 現在値（18px、normal、%付き、小数点1桁）
  // - 増加値（+X.X%、Tier別色分け背景、15px）
  // - ランクバッジ（S/A/B/C、色付き、12px太字）
  // - 右側余白: 95px固定（揃え用）
}
```

### 5.2 入力系コンポーネント

#### UIDInput（UID入力フィールド）
```dart
class UIDInput extends StatefulWidget {
  final void Function(String uid) onSubmit;
  final String? errorMessage;
  
  // UID入力用のテキストフィールド
  // - 9桁の数字のみ入力可能
  // - バリデーション
  // - エラー表示
}
```

#### StatSelector（ステータス選択）
```dart
class StatSelector extends StatefulWidget {
  final ScoringSettings initialSettings;
  final void Function(ScoringSettings) onChanged;
  
  // スコアリング対象ステータスの選択UI
  // - チェックボックスリスト
  // - プリセットボタン
}
```

### 5.3 フィードバック系コンポーネント

#### LoadingIndicator（ローディング表示）
```dart
class LoadingIndicator extends StatelessWidget {
  final String message;
  
  // ローディング中の表示
  // - スピナー
  // - メッセージ
}
```

#### ErrorDisplay（エラー表示）
```dart
class ErrorDisplay extends StatelessWidget {
  final String message;
  final VoidCallback? onRetry;
  
  // エラーメッセージ表示
  // - アイコン
  // - メッセージ
  // - リトライボタン（オプション）
}
```

---

## 6. レスポンシブ対応

### ブレークポイント

| デバイス | 幅 | レイアウト |
|---------|-----|-----------|
| モバイル | 〜 600px | 1カラム、シングルビュー |
| タブレット | 601px 〜 1024px | 2カラム、サイドメニュー |
| デスクトップ | 1025px 〜 | 3カラム、フル機能 |

### モバイル優先設計
- まずモバイルUIを完成させる
- 段階的にデスクトップ機能を追加
- タッチ操作を前提とした大きなタップ領域

---

## 7. アクセシビリティ

### 基本要件
- **コントラスト比**: WCAG AA準拠（4.5:1以上）
- **フォントサイズ**: 最小14px（本文）、16px（ボタン）
- **タッチ領域**: 最小44x44px
- **キーボード操作**: 全機能がキーボードで操作可能
- **スクリーンリーダー**: 適切なラベル付け

### カラーユニバーサルデザイン
- 色だけに頼らない情報伝達
- ランクは色+アイコンで表現
- グラフには補助線やラベルを追加

---

## 📝 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-10-12 | 初版作成、基本UI設計とコンポーネント定義 |
| 2025-10-12 | 部位別スコアランク基準を反映(花羽（基本）、砂/杯-5.0、冠-10.0) |
| 2025-10-13 | UI拡大仕様を追加（1.5倍、340×360px、フォント18-20px） |
| 2025-10-13 | 実装済み機能を反映（スコアリング、ランク表示、詳細画面統一） |
